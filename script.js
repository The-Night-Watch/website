"use strict";HTMLCollection.prototype.forEach=Array.prototype.forEach;let mobile=window.matchMedia("(max-width: 800px)");function main(){document.body.classList.add("loaded"),document.querySelectorAll("article").forEach(e=>new Article(e)),document.querySelectorAll("video:not([autoplay])").forEach(e=>new Video(e)),document.querySelectorAll("#projects").forEach(e=>new Carousel(e)),mobile.matches&&document.querySelectorAll(".zoomable").forEach(e=>new Zoomable(e))}class Article{top=!0;bottom=!1;sections=[];constructor(e){this.element=e;const t=new IntersectionObserver(this.intersectMarker.bind(this));this.createMarker("top",t),this.createMarker("bottom",t);const n={rootMargin:"-49% 0% -49% 0%"},s=new IntersectionObserver(this.intersectSection.bind(this),n);e.querySelectorAll("section").forEach((e,t)=>{this.sections.push(new Section(e,t,s))}),this.toggleSection(0),this.sections[0].loadMedias()}createMarker(e,t){const n=document.createElement("div");n.className="marker",n.dataset.position=e,this.element.append(n),t.observe(n)}toggleSection(e){this.sections.forEach(t=>t.toggle(t.index===e)),e<this.sections.length-1&&this.sections[e+1].loadMedias()}intersectMarker(e){e.forEach(e=>{document.body.classList.toggle(e.target.dataset.position,e.isIntersecting)}),document.body.classList.toggle("scrolled",!e.find(e=>e.target.dataset.position==="top"&&e.isIntersecting))}intersectSection(e){const t=e.find(e=>e.isIntersecting);t&&this.toggleSection(parseInt(t.target.dataset.index))}}class Section{constructor(e,t,n){this.element=e,this.element.dataset.index=t,this.index=t,n.observe(e),this.active=!1}loadMedias(){!this.element.dataset.loaded&&this.element.querySelectorAll("picture, video").forEach(this.loadMedia),this.element.dataset.loaded=!0}loadMedia(e){e.children.forEach(e=>{e.hasAttribute("data-srcset")&&(e.srcset=e.dataset.srcset)}),e.children.forEach(e=>{e.hasAttribute("data-src")&&(e.src=e.dataset.src)}),e.tagName==="VIDEO"&&e.load()}toggle(e){this.active=e,this.element.classList.toggle("active",e),e&&!mobile.matches&&document.body.classList.toggle("dark",this.element.dataset.dark==="true")}}class Video{_playing=!1;_inProgress=!1;constructor(e){this.element=e,this.controls=document.createElement("div"),this.controls.classList.add("video-controls"),this.controls.onclick=this.toggle.bind(this),this.timeline=document.createElement("input"),this.timeline=document.createElement("input"),this.timeline.type="range",this.timeline.min="0",this.timeline.max="100",this.timeline.value="0",this.timeline.onchange=this.change.bind(this),this.controls.append(this.timeline),this.element.ontimeupdate=this.updateTime.bind(this),this.element.onended=this.end.bind(this),this.element.after(this.controls)}toggle(e){!this.playing&&this.element.closest("section").scrollIntoView({behavior:"smooth",block:"center"}),this.playing=e.target===this.controls?!this.playing:this.playing,this.playing&&this.element.play()||this.element.pause(),this.inProgress=!0}updateTime(){const e=100*this.element.currentTime/this.element.duration;this.timeline.style.backgroundSize=`${e}% 100%`,this.timeline.value=e}change(){const e=this.timeline.value*this.element.duration/100;this.element.currentTime=e}end(){this.playing=!1,this.inProgress=!1}set inProgress(e){this._inProgress=e,this.controls.classList.toggle("in-progress",e)}get inProgress(){return this._inProgress}set playing(e){this._playing=e,this.controls.classList.toggle("playing",e)}get playing(){return this._playing}}class Carousel{constructor(e){this.element=e,this.restorePosition(),document.body.onunload=this.savePosition,document.body.onwheel=this.scroll}savePosition=()=>this.position=document.body.scrollLeft;restorePosition=()=>this.position&&document.body.scroll(this.position,0);scroll=e=>window.scrollBy(e.deltaY,0);set position(e){localStorage.setItem("carousel-position",e)}get position(){return localStorage.getItem("carousel-position")}}class Zoomable{constructor(e){this.element=e,this.zoomed=!1,e.querySelector("img, video").onclick=this.zoom;const t=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("width","21"),t.setAttribute("height","21"),t.setAttribute("fill","none"),t.setAttribute("viewBox","0 0 21 21"),t.classList.add("icon"),n.setAttribute("stroke-linecap","round"),n.setAttribute("stroke-linejoin","round"),n.setAttribute("stroke-width","2"),n.setAttribute("d","M19 19L12.7485 12.7485M12.7485 12.7485C13.8879 11.609 14.5926 10.035 14.5926 8.2963C14.5926 4.81895 11.7736 2 8.2963 2C4.81895 2 2 4.81895 2 8.2963C2 11.7736 4.81895 14.5926 8.2963 14.5926C10.035 14.5926 11.609 13.8879 12.7485 12.7485Z"),t.appendChild(n),e.appendChild(t)}zoom=e=>{this.zoomed=!this.zoomed,this.element.classList.toggle("zoomed",this.zoomed),document.body.classList.toggle("zoomed",this.zoomed),this.zoomed&&this.element.scrollTo(this.element.scrollWidth/2-window.screen.width/2,0),this.element.scrollIntoView({behavior:"smooth",block:"center"})}}window.onload=main